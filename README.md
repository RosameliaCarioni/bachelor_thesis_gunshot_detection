# Identification Of Gunshots In Passive Acoustic Monitoring Recordings Using Convolutional Neural Networks

## Description
This codes is part of my bachelor's thesis work on gunshot identification in passie acoustic monitoring. The project aimed at enhancing the accuracy of gunshot detection in environmental audio signals through the exploration of Convolutional Neural Network (CNN) architectures and various pre-processing techniques. The techniques considered encompass denoising, augmentation, and feature extraction. The primary objective of this study is to develop a CNN-based model that surpasses the current Data Template Detector from the Elephant Listening Project (ELP), particularly in terms of precision, and recall for gunshot identification. 

The results of this work demonstrate that constructing a CNN model using Bayesian hyperparameter optimization and incorporating data augmentation, low-pass filtering with a cutoff frequency of 1500 Hz, and extraction of deltas and delta-deltas Mel-frequency cepstral coefficients as pre-processing techniques yield a highly accurate model capable of predicting the presence of a gunshot with an accuracy rate of 99\%, and a precision and recall of 100\% and 96\%, respectively.

## Report:
For a detailed understanding of the research and methodologies employed in this project, you can refer to the [report](https://drive.google.com/file/d/1ZuRUnGzWbor3GLN9bOO2Nc_efPYf-5-W/view?usp=share_link).

## Author
Rosamelia Carioni Porras

## Supervisors 
Main supervisor: Pietro Bonizzi

Second supervisor: Marijn ten Thij

## Installation

To get all the required packages do:
```
pip install -r requirements.txt
```

## Structure of the code

The organization of the files and work can be understood as follows:
1. The generation of clips from the 24-hour long recordings provided by ELP can be found under the folder `data_preprocessing`. The clips were generated by using dataframes with timestamps provided by the organization and by downaloading from AWS some of the files (some of them were provided by the organization directly). 

2. The methods used in the training and evaluation of the different models can be found under the `methods_audio` folder. The methods include the generation of new data, application of different denoising techniques, generation of plots from signals, etc.

3.  To obtain the different models (architectures), the folder `models` was created, which contains a class in charge of returning a specific model based on what is asked to the method. 

4. Different models architectures were built with hyperparameter tunning, more specifically, Bayesian Optimization. The files where they were built can be found under the jupyter notebooks called: `build_model_*`

5. To answer the research questions of this work, different experiments were performed. For more details about the different experiments refer to the notebookes: `experiment_*`

6. After experiments were perfomed and answer to which pre-processing techniques are best to identify gunshots in environemntal sounds, a final set of 4 different models were trained and tested with the test set provided by the organization. The code for the training of the models can be found under the jupyter notebook: `train_final_models.ipynb`, whereas the code for the testing can be found under: `results_test_set.ipynb`. 

Note that the code here is meant as a reference to see what was done in this study and is not meant to be run by other people, as not all the data is not publically available. If you would like to run this code you would need to get the data and update the paths in the code which reference it. 
